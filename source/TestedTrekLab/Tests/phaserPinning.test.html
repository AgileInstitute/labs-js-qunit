<!Doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>phaserPinning.test</title>
  <link rel="stylesheet" href="../../../lib/qunit.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="../../../lib/qunit.js"></script>
  <script src="../../../lib/jquery.js"></script>
  <script src="../../../lib/sinon.js"></script>
  <script src="../StarTrek/game.js"></script>
  <script src="../StarTrek/klingon.js"></script>
  <script src="../Untouchables/userInterface.js"></script>
  <script>

    module("phaser", {
        setup: function() {
			// given
            this.game = new Game();
            this.ui = new UserInterface("phaser");
            sinon.stub(this.ui, "writeLine");
        }
    });

    test("PhasersFiredWithInsufficientEnergy", function() {
        // given
        this.ui.commandParameter = this.game.energy + 1;

        // when
        this.game.processCommand(this.ui);

        // then
        equal(this.ui.writeLine.args[0], "Insufficient energy to fire phasers!");
    });

    test("EnergyExpendedEvenWhenPhasersFiredWhileKlingonOutOfRange", function() {
        // given
        var outOfRange = this.game.maxPhaserRange + 1;
        var klingon = new Klingon();
        klingon.distance = outOfRange;
        this.ui.target = klingon;
        this.ui.commandParameter = 1000;
        var energyBefore = this.game.e;

        // when
        this.game.processCommand(this.ui);

        // then
        equal(this.ui.writeLine.args[0], "Klingon out of range of phasers at " + outOfRange + " sectors...");
        equal(this.game.e, energyBefore - 1000);
    });


  </script>
</body>
</html>
